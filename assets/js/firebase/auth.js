// assets/js/firebase/auth.js

import { auth } from "../app.js";
import {
    signInWithPopup,
    GoogleAuthProvider,
    FacebookAuthProvider,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    sendPasswordResetEmail
} from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

const googleProvider = new GoogleAuthProvider();
const facebookProvider = new FacebookAuthProvider();

// ==== GOOGLE ====
export async function loginWithGoogle() {
    try {
        await signInWithPopup(auth, googleProvider);
        console.log("‚úÖ Google –≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω");
    } catch (err) {
        console.error("‚ùå –û—à–∏–±–∫–∞ Google –≤—Ö–æ–¥–∞:", err);
    }
}

// ==== FACEBOOK ====
export async function loginWithFacebook() {
    try {
        await signInWithPopup(auth, facebookProvider);
        console.log("‚úÖ Facebook –≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω");
    } catch (err) {
        console.error("‚ùå –û—à–∏–±–∫–∞ Facebook –≤—Ö–æ–¥–∞:", err);
    }
}

// ==== EMAIL –í–•–û–î ====
export async function loginWithEmail(email, password) {
    try {
        await signInWithEmailAndPassword(auth, email, password);
        console.log("‚úÖ Email –≤—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω");
    } catch (err) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:", err.message);
        alert(err.message);
    }
}

// ==== EMAIL –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø ====
export async function registerWithEmail(email, password) {
    try {
        await createUserWithEmailAndPassword(auth, email, password);
        console.log("‚úÖ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω");
    } catch (err) {
        console.error("‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:", err.message);
        alert(err.message);
    }
}

// ==== RESET PASSWORD ====
export async function resetPassword(email) {
    try {
        await sendPasswordResetEmail(auth, email);
        alert("üì© –°—Å—ã–ª–∫–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ email");
    } catch (err) {
        console.error("‚ùå –û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:", err.message);
        alert(err.message);
    }
}
