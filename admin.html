<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>URSA Admin Panel — v4</title>   <meta name="theme-color" content="#0d1117" />
  <meta name="color-scheme" content="dark" />

    <link rel="stylesheet" href="assets/css/admin.css?v=3" />
</head>

<body>
<noscript>
  <div style="padding:14px;background:#ff5252;color:#000;font-weight:600;text-align:center">
    Для работы панели администрирования требуется включённый JavaScript.
  </div>
</noscript>

<div id="root" class="admin-root">
    <section id="admin-auth" class="auth-screen" role="dialog" aria-labelledby="auth-title" aria-modal="true">
    <div class="auth-card" role="document">
      <h1 id="auth-title" class="brand-xl">URSA <span>ADMIN</span></h1>
      <p class="muted">Вход только для администраторов. Используйте Google-аккаунт.</p>
      <button id="auth-login-btn" class="btn btn-accent" aria-label="Войти через Google">Войти через Google</button>
      <p id="auth-error" class="error-text" aria-live="polite"></p>
    </div>
  </section>

    <div id="admin-app" class="app-shell" style="display:none">
        <aside class="sidebar" role="navigation" aria-label="Основная навигация">
      <div class="sidebar-brand">
        <div class="logo-dot" aria-hidden="true"></div>
        <div class="brand">URSA <span>ADMIN</span></div>
      </div>

      <nav class="side-nav">
        <button class="side-link" data-view="dashboard" aria-controls="view-dashboard" aria-selected="false">
          <span class="ic" aria-hidden="true">📊</span>
          Дашборд
        </button>
        <button class="side-link" data-view="apps" aria-controls="view-apps" aria-selected="false">
          <span class="ic" aria-hidden="true">📱</span>
          Приложения
        </button>
        <button class="side-link" data-view="users" aria-controls="view-users" aria-selected="false">
          <span class="ic" aria-hidden="true">👥</span>
          Пользователи
        </button>
                <button class="side-link active" data-view="orders" aria-controls="view-orders" aria-selected="true">
          <span class="ic" aria-hidden="true">💸</span>
          VIP Заявки
          <span id="orders-counter" class="pill" aria-label="Активных VIP заявок">0</span>
        </button>
        <button class="side-link" data-view="cert-orders" aria-controls="view-cert-orders" aria-selected="false">
          <span class="ic" aria-hidden="true">🔐</span>
          Cert Заявки
          <span id="cert-orders-counter" class="pill" aria-label="Активных заявок на сертификаты">0</span>
        </button>
      </nav>

      <div class="side-bottom">
        <button id="admin-logout-btn" class="side-link danger" aria-label="Выйти из админ-панели">↩ Выход</button>
      </div>
    </aside>

        <main class="main" role="main">
            <header class="topbar" role="banner">
        <div class="crumbs" id="topbar-title">💸 VIP Заявки</div>
        <div class="top-actions">
          <div class="kbd-hint" title="Нажмите / для поиска">/</div>
        </div>
      </header>

            <div class="views">
                <section id="view-dashboard" class="view" tabindex="0" aria-labelledby="dashboard-title">
          <h2 id="dashboard-title" class="sr-only">Общая статистика</h2>
          <div class="stats-grid">
            <article class="stat-card" role="status" aria-live="polite">
              <div class="stat-label">Всего приложений</div>
              <div id="stat-apps" class="stat-value">0</div>
            </article>
            <article class="stat-card" role="status" aria-live="polite">
              <div class="stat-label">VIP-пользователей</div>
              <div id="stat-vip" class="stat-value">0</div>
            </article>
            <article class="stat-card" role="status" aria-live="polite">
              <div class="stat-label">Активные заказы</div>
              <div id="stat-orders" class="stat-value">0</div>
            </article>
            <article class="stat-card" role="status" aria-live="polite">
              <div class="stat-label">UDID в базе</div>
              <div id="stat-signers" class="stat-value">0</div>
            </article>
          </div>
        </section>

                <section id="view-apps" class="view" tabindex="0" aria-labelledby="apps-title">
          <div class="view-head">
            <h2 id="apps-title">Каталог приложений</h2>
            <div class="view-actions">
              <button id="add-app-btn" class="btn btn-ghost small">➕ Добавить</button>
            </div>
          </div>

          <div class="filters">
            <label class="sr-only" for="app-search">Поиск по названию</label>
            <input id="app-search" class="input" type="search" placeholder="Поиск по названию…" inputmode="search" />
            <select id="app-filter" class="select">
              <option value="all">Все</option>
              <option value="apps">Apps</option>
              <option value="games">Games</option>
              <option value="update">Update</option>
              <option value="vip">VIP</option>
            </select>
          </div>

          <div id="apps-grid" class="apps-grid" aria-busy="true" aria-live="polite"></div>
          <div id="apps-skeleton" class="grid-skeleton">
            <div class="card-skel"></div>
            <div class="card-skel"></div>
            <div class="card-skel"></div>
            <div class="card-skel"></div>
            <div class="card-skel"></div>
            <div class="card-skel"></div>
          </div>
        </section>

                <section id="view-users" class="view" tabindex="0" aria-labelledby="users-title">
          <div class="view-head">
            <h2 id="users-title">Пользователи</h2>
          </div>

          <div class="filters">
            <label class="sr-only" for="user-search">Поиск по Email/UID</label>
            <input id="user-search" class="input" type="search" placeholder="Поиск по Email/UID…" inputmode="search" />
          </div>

          <div class="table-wrap">
            <table class="data-table" id="users-table">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>UID</th>
                  <th>Статус</th>
                  <th>Сертификат</th>
                  <th>Действия</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <div id="users-skeleton" class="list-skeleton">
            <div class="row-skel"></div>
            <div class="row-skel"></div>
            <div class="row-skel"></div>
          </div>
        </section>

                <section id="view-orders" class="view active" tabindex="0" aria-labelledby="orders-title">
          <div class="view-head">
            <h2 id="orders-title">VIP Заявки</h2>
            <div class="view-actions">
              <select id="orders-status" class="select">
                <option value="all">Все</option>
                <option value="pending">Ожидает</option>
                <option value="processing">В работе</option>
                <option value="completed">Завершено</option>
                <option value="canceled">Отменено</option>
              </select>
            </div>
          </div>

          <div class="filters">
            <input id="order-search" class="input" type="search" placeholder="Поиск по UID/Order ID…" inputmode="search" />
          </div>

          <ul id="orders-list" class="orders-list" aria-live="polite"></ul>

          <div id="orders-skeleton" class="list-skeleton">
            <div class="row-skel"></div>
            <div class="row-skel"></div>
            <div class="row-skel"></div>
          </div>
        </section>
        
        <section id="view-cert-orders" class="view" tabindex="0" aria-labelledby="cert-orders-title">
          <div class="view-head">
            <h2 id="cert-orders-title">🔐 Заявки на Сертификаты</h2>
            <div class="view-actions">
              <select id="cert-orders-status" class="select">
                <option value="all">Все</option>
                <option value="pending">Ожидает</option>
                <option value="processing">В работе</option>
                <option value="completed">Завершено</option>
                <option value="canceled">Отменено</option>
              </select>
            </div>
          </div>

          <div class="filters">
            <input id="cert-order-search" class="input" type="search" placeholder="Поиск по UID/Order ID…" inputmode="search" />
          </div>

          <ul id="cert-orders-list" class="orders-list" aria-live="polite"></ul>

          <div id="cert-orders-skeleton" class="list-skeleton">
            <div class="row-skel"></div>
            <div class="row-skel"></div>
            <div class="row-skel"></div>
          </div>
        </section>
        
      </div>
    </main>

        <aside id="chat-panel" class="chat-panel" aria-labelledby="chat-title" aria-hidden="true">
      <header class="chat-head">
        <div class="chat-title">
          <h3 id="chat-title">Заявка: <span id="chat-order-id">—</span></h3>
          <div class="sub" id="chat-order-meta">Тип/Метод: — • UID: —</div>         </div>
        <button id="chat-close" class="icon-btn" aria-label="Закрыть чат">✕</button>
      </header>

      <div class="chat-toolbar">
        <select id="order-status-select" class="select small">
          <option value="pending">Ожидает</option>
          <option value="processing">В работе</option>
          <option value="completed">Завершено</option>
          <option value="canceled">Отменено</option>
        </select>
        <button id="set-vip-btn" class="btn btn-accent small">✅ Выдать VIP</button>
      </div>

      <div id="admin-chat-area" class="chat-scroll" aria-live="polite"></div>

      <form id="chat-form" class="chat-input" autocomplete="off">
        <label class="sr-only" for="admin-chat-input">Сообщение</label>
        <input id="admin-chat-input" type="text" class="input" placeholder="Ответить пользователю…" />
        <button id="admin-chat-send" class="btn btn-ghost" type="submit" aria-label="Отправить">➤</button>
      </form>
    </aside>
  </div>
</div>

<div id="app-modal" class="modal" aria-hidden="true" aria-labelledby="app-modal-title" role="dialog">
  <div class="modal-card">
    <button class="modal-close" data-action="close" aria-label="Закрыть">✕</button>
    <h3 id="app-modal-title">Редактировать приложение</h3>
    <form id="app-edit-form">
      <input type="hidden" id="app-id" />

      <label for="app-name">Название</label>
      <input type="text" id="app-name" required autocomplete="off" />

      <label for="app-version">Версия</label>
      <input type="text" id="app-version" inputmode="text" autocomplete="off" />

      <label for="app-url">Ссылка на IPA/DownloadUrl</label>
      <input type="url" id="app-url" required inputmode="url" placeholder="https://…" />

      <label for="app-icon">URL иконки (200×200)</label>
      <input type="url" id="app-icon" inputmode="url" placeholder="https://…" />

      <label for="app-tags">Теги (apps, games, update) через запятую</label>
      <input type="text" id="app-tags" inputmode="text" placeholder="apps, games" />

      <div class="checkbox-line">
        <input type="checkbox" id="app-vip-only" />
        <label for="app-vip-only">Только для VIP</label>
      </div>

      <label for="app-desc">Описание</label>
      <textarea id="app-desc" placeholder="Короткое описание…"></textarea>

      <div class="modal-actions">
        <button type="submit" class="btn btn-accent">Сохранить</button>
        <button type="button" class="btn btn-danger" id="app-delete-btn" style="display:none;">Удалить</button>
      </div>
    </form>
  </div>
</div>

<div class="sr-only" aria-hidden="true">.</div>

<script type="module" src="assets/js/app.js?v=1"></script>
<script type="module" src="assets/js/admin.js?v=4"></script> </body>
</html>
