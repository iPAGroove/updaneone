<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>URSA IPA ‚Äî PWA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
  
  <!-- iOS PWA fullscreen & title -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="URSA">

  <!-- PWA Icons -->
  <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/iPAGroove/updaneone/main/icons/pwa.jpeg?v=11">
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/iPAGroove/updaneone/main/icons/pwa.jpeg?v=11">

  <!-- Manifest -->
  <link rel="manifest" href="./pwa/manifest.json?v=11">

  <!-- Styles -->
  <link rel="stylesheet" href="./starts/instructions.css?v=11">
</head>

<body>
  <div class="wrap">
    <h1 class="title">URSA</h1>

    <div class="card">

      <p class="text">
        –ß—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω.
      </p>

      <img src="./starts/pwa-guide.png" class="guide-img" alt="Guide">

      <p class="steps">
        üìå Safari ‚Üí –ü–æ–¥–µ–ª–∏—Ç—å—Å—è ‚Üí <br>
        ¬´–ù–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª
      </p>

      <button id="continueBtn" class="btn" disabled>
        –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞‚Ä¶
      </button>

    </div>
  </div>

<script>
// ===== SUPER-ULTRA-RELIABLE PWA DETECTION ===== //

function isPWAMode() {
  if (window.navigator.standalone === true) return true;

  const modes = ["standalone", "fullscreen", "minimal-ui"];
  for (let mode of modes) {
    if (window.matchMedia("(display-mode: " + mode + ")").matches) {
      return true;
    }
  }

  return false;
}

function tryRedirect() {
  if (isPWAMode()) {
    console.log("[URSA] PWA detected ‚Üí redirect");
    window.location.replace("./home.html?v=11");
    return true;
  }
  return false;
}

document.addEventListener("DOMContentLoaded", () => {
  const btn = document.getElementById("continueBtn");
  btn.textContent = "–î–æ–±–∞–≤—å—Ç–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω";
  btn.disabled = true;

  let attempts = 0;
  const interval = setInterval(() => {
    attempts++;
    if (tryRedirect() || attempts > 15) clearInterval(interval);
  }, 200);
});
</script>

</body>
</html>
