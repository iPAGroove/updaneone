<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <title>URSA IPA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no" />

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/core.css" />
    <link rel="stylesheet" href="assets/css/header.css" />
    <link rel="stylesheet" href="assets/css/navigation.css" />
    <link rel="stylesheet" href="assets/css/catalog.css" />
    <link rel="stylesheet" href="assets/css/modal.css" />
    <link rel="stylesheet" href="assets/css/all-catalog.css" />
    <link rel="stylesheet" href="assets/css/search.css" />
    <link rel="stylesheet" href="assets/css/menu.css" />
    <link rel="stylesheet" href="assets/css/cert.css" /> <!-- Добавлен CSS для сертификата -->
</head>
<body>

<header class="topbar">
    <div class="wrap">
        <div class="brand"><span>URSA IPA</span></div>
    </div>
</header>

<main>
    <div class="wrap">
        <div id="catalog" class="catalog" role="list">

            <section class="collection-row">
                <h2 class="collection-title">Popular</h2>
                <div class="card-carousel"></div>
                <button class="view-all-btn">Смотреть все</button>
            </section>

            <section class="collection-row">
                <h2 class="collection-title">Update</h2>
                <div class="card-carousel"></div>
                <button class="view-all-btn">Смотреть все</button>
            </section>

            <section class="collection-row">
                <h2 class="collection-title">VIP</h2>
                <div class="card-carousel"></div>
                <button class="view-all-btn">Смотреть все</button>
            </section>

        </div>
    </div>
</main>

<!-- NAVIGATION -->
<nav class="tabbar" id="tabbar" role="tablist">
    <div class="newdock">
        <button class="nav-btn active" data-tab="apps">📱</button>
        <button class="nav-btn" data-tab="games">🎮</button>
        <button class="nav-btn" id="search-btn">🔍</button>
        <button class="nav-btn" id="menu-btn">☰</button>
    </div>
</nav>

<!-- === APP MODAL === -->
<div class="modal-overlay" id="app-modal">
    <div class="modal-content">
        <button class="modal-close-btn" data-action="close">✕</button>

        <div class="modal-header-new">
            <img id="modal-icon" class="modal-icon" src="" alt="">
            <div class="modal-info-col">
                <h3 id="modal-title" class="modal-app-title">Название</h3>
                <a id="modal-cta" class="btn modal-install-btn" href="#" target="_blank">Установить</a>
            </div>
        </div>

        <div class="modal-metadata-new">
            <p>Версия<strong><span id="modal-version">N/A</span></strong></p>
            <p>Размер<strong><span id="modal-size">N/A</span></strong></p>
            <p>Загружено<strong><span id="modal-time-ago">N/A</span></strong></p>
        </div>

        <div class="modal-features-new">
            <h4>ФУНКЦИИ МОДА</h4>
            <pre id="modal-features"></pre>
        </div>

        <div class="modal-description-new">
            <p id="modal-desc"></p>
        </div>
    </div>
</div>

<!-- === FULL LIST MODAL === -->
<div class="all-list-overlay" id="all-catalog-modal">
    <div class="all-list-content">
        <button class="all-close-btn" data-action="close-list">✕</button>
        <h2 id="all-list-title">Каталог</h2>
        <div id="all-list-container" class="all-list-scroll"></div>
    </div>
</div>

<!-- === SEARCH MODAL === -->
<div class="search-overlay" id="search-modal">
    <div class="search-content">
        <input type="text" id="search-input" placeholder="Поиск приложений..." autocomplete="off">
        <p class="search-hint">Нажмите вне поиска, чтобы закрыть</p>
        <div id="search-results" class="search-results"></div>
    </div>
</div>

<!-- === MENU MODAL === -->
<div class="menu-overlay" id="menu-modal">
    <div class="menu-content">
        <button class="menu-close-btn" data-action="close-menu">←</button>

        <div class="user-profile">
            <img id="user-avatar" src="https://placehold.co/100x100/121722/00b3ff?text=User" class="avatar">
            <h3 id="user-nickname" class="nickname">Гость</h3>
        </div>

        <div class="login-options">
            <p class="login-prompt">Войти через:</p>
            <div class="login-buttons">
                <button class="auth-btn google-auth" title="Google">G</button>
                <button class="auth-btn facebook-auth" title="Facebook">f</button>
                <button class="auth-btn email-auth" title="Email">✉️</button>
            </div>
        </div>

        <!-- 🔑 ОБНОВЛЕННЫЙ БЛОК СЕРТИФИКАТА -->
        <div class="certificate-card" id="certificate-card">
            <div id="cert-info-display" style="display: none;">
                <p class="cert-data">UDID: <strong><span id="cert-udid">N/A</span></strong></p>
                <p class="cert-data">Доступен до: <strong><span id="cert-expiry">N/A</span></strong></p>
                <button class="btn delete-cert-btn">Удалить сертификат</button>
            </div>
            <div id="cert-info-placeholder">
                <p class="cert-info-placeholder">Данные о сертификате будут здесь</p>
                <button class="btn add-cert-btn" id="add-cert-btn">Добавить сертификат</button>
            </div>
        </div>

        <button class="btn menu-action-btn select-plan-btn">Выбрать план</button>
        <button class="btn menu-action-btn buy-cert-btn">Купить сертификат</button>
        <button class="btn menu-action-btn change-lang-btn">Сменить язык</button>
        <button class="btn menu-action-btn about-us-btn">О нас</button>

    </div>
</div>

<!-- === CERTIFICATE UPLOAD MODAL (НОВОЕ ОКНО) === -->
<div id="cert-upload-modal" class="cert-upload-overlay">
  <div class="cert-modal-content">
    <button class="menu-close-btn" data-action="close-cert">←</button>
    <h2 class="cert-title">Добавить сертификат</h2>

    <div class="file-upload-section">
      <label for="p12-file" class="upload-label">
        Выбрать файл **.p12**
      </label>
      <input type="file" id="p12-file" accept=".p12" required>
      <span id="p12-filename" class="filename-display">Файл не выбран</span>
    </div>

    <div class="file-upload-section">
      <label for="mobileprovision-file" class="upload-label">
        Выбрать файл **.mobileprovision**
      </label>
      <input type="file" id="mobileprovision-file" accept=".mobileprovision" required>
      <span id="mp-filename" class="filename-display">Файл не выбран</span>
    </div>

    <input type="password" id="cert-password-input" placeholder="Пароль сертификата (если есть)" class="auth-input" autocomplete="new-password">

    <button class="email-submit-btn" id="import-cert-btn">
      Импортировать
    </button>
    <p id="cert-upload-status" class="status-text"></p>
  </div>
</div>

<!-- === EMAIL AUTH MODAL (NO AUTO-FILL / NO AUTO-LOGIN) === -->
<div id="email-modal" class="email-auth-overlay">
  <div class="email-modal-content">
    <button class="menu-close-btn" data-action="close-email">←</button>
    <h2 class="email-title">Вход / Регистрация</h2>

    <input type="text" id="email-input" placeholder="Email" class="auth-input"
        autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false">

    <input type="password" id="password-input" placeholder="Пароль" class="auth-input"
        autocomplete="new-password" autocorrect="off" autocapitalize="none" spellcheck="false">

    <button class="email-submit-btn" id="email-login-btn">Войти</button>
    <button class="email-register-btn" id="email-register-btn">Создать аккаунт</button>
    <button class="email-reset-btn" id="email-reset-btn">Забыли пароль?</button>
  </div>
</div>

<!-- === SCRIPTS === -->
<script type="module" src="assets/js/app.js"></script>
<script type="module" src="assets/js/firebase/auth.js"></script>
<script type="module" src="assets/js/firebase/user.js"></script>
<script type="module" src="assets/js/cert-manager.js"></script> <!-- 🔑 Новый модуль для логики сертификата -->
<script type="module" src="assets/js/navigation.js"></script>
<script type="module" src="assets/js/modal.js"></script>
<script type="module" src="assets/js/all-catalog.js"></script>
<script type="module" src="assets/js/search.js"></script>
<script type="module" src="assets/js/menu.js"></script>

</body>
</html>
